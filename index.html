<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Field Notes</title>

<style>
:root{
  --bg: #0e0b08;
  --bg2: #1b1510;
  --fg: #efe6d3;
  --muted: rgba(239,230,211,.62);
  --card: rgba(28,22,17,.88);
  --border: rgba(223,198,150,.32);
  --accent: #c09a5b;
  --paper: #f4efe4;
  --paper-ink: #2c241c;
  --paper-muted: rgba(44,36,28,.55);
}

*{ box-sizing: border-box; }

html, body{
  height: 100%;
  width: 100%;
}

body{
  margin: 0;
  font-family: "Iowan Old Style", "Garamond", "Times New Roman", serif;
  font-size: 15px;
  letter-spacing: 0.2px;
  color: var(--fg);
  background:
    radial-gradient(1200px 600px at 20% 10%, rgba(255,255,255,.05), transparent 60%),
    radial-gradient(900px 500px at 80% 90%, rgba(255,255,255,.03), transparent 55%),
    linear-gradient(145deg, var(--bg2), var(--bg));
  overflow-x: auto;
  overflow-y: hidden;
  scroll-snap-type: x mandatory;
  scroll-behavior: smooth;   /* ðŸ”¥ smoother transitions */
  display: flex;
}

.slide{
  height: 100vh;
  min-width: 100%;
  scroll-snap-align: start;
  display: grid;
  place-items: center;
  padding: 24px;
}

.card{
  width: min(820px, 88vw);
  border: 1px solid var(--border);
  background:
    linear-gradient(0deg, rgba(255,255,255,.02), rgba(0,0,0,.08)),
    var(--card);
  padding: 18px 18px 22px;
  box-shadow: 0 10px 24px rgba(0,0,0,.35);

  transform: rotate(-0.3deg);   /* ðŸ”¥ Analog drift */
}


/* ðŸ”¥ IMAGE FIX */
.img{
  width: 100%;
  aspect-ratio: 4 / 3;
  border: 1px solid var(--border);
  overflow: hidden;
  background: rgba(0,0,0,.2);
}

.img img{
  width: 100%;
  height: 100%;
  object-fit: contain;
  cursor: zoom-in;
}

.phrase{
  font-size: 22px;
  margin: 6px 0 12px;
}

.label{
  font-size: 11px;
  color: var(--paper-muted);
  text-transform: uppercase;
  letter-spacing: 1.5px;
}

.card h1{
  font-size: 22px;
  font-weight: 600;
  letter-spacing: 0.6px;
  text-transform: uppercase;
  margin: 2px 0 12px;
}

.card .paper{
  border: 1px dashed rgba(44,36,28,.35);
  background:
    repeating-linear-gradient(
      0deg,
      rgba(0,0,0,.02),
      rgba(0,0,0,.02) 1px,
      transparent 1px,
      transparent 4px
    ),
    var(--paper);
  color: var(--paper-ink);
  padding: 14px;
  margin: 12px 0 8px;
}

button{
  font-family: "Courier New", Courier, monospace;
  font-size: 12px;
  letter-spacing: 1px;
  text-transform: uppercase;
  border: 1px solid var(--border);
  background: transparent;
  color: var(--fg);
  padding: 8px 12px;
  margin-top: 6px;
}

button:hover{
  border-color: var(--accent);
  color: var(--accent);
  cursor: pointer;
}

.archive-toggle{
  position: fixed;
  top: 16px;
  right: 16px;
  z-index: 10;
  padding: 12px 16px;
  font-size: 13px;
}

.archive-panel{
  position: fixed;
  top: 52px;
  right: 16px;
  width: min(260px, 80vw);
  max-height: 70vh;
  overflow: auto;
  z-index: 10;
  border: 1px solid var(--border);
  background:
    repeating-linear-gradient(
      0deg,
      rgba(0,0,0,.02),
      rgba(0,0,0,.02) 1px,
      transparent 1px,
      transparent 4px
    ),
    var(--paper);
  color: var(--paper-ink);
  padding: 10px;
  display: none;
}

.archive-panel h2{
  font-size: 12px;
  margin: 0 0 8px;
  text-transform: uppercase;
  letter-spacing: 1.2px;
}

.archive-panel audio{
  width: 100%;
  margin: 6px 0;
}

.image-zoom{
  position: fixed;
  inset: 0;
  background: rgba(8,7,6,.85);
  display: none;
  place-items: center;
  z-index: 20;
}

.image-zoom img{
  max-width: 92vw;
  max-height: 92vh;
  object-fit: contain;
  border: 1px solid var(--border);
  background: rgba(0,0,0,.2);
  cursor: zoom-out;
}

@media (max-width: 700px){
  body{
    font-size: 14px;
  }

  .card{
    width: 92vw;
  }

  .card h1{
    font-size: 20px;
  }

  .phrase{
    font-size: 21px;
  }
}
</style>
</head>

<body id="container"></body>

<script>
let currentSlide = 0;

function updateCurrentSlide() {
    const slideWidth = window.innerWidth;
    currentSlide = Math.round(window.scrollX / slideWidth);
}

window.addEventListener("scroll", updateCurrentSlide, { passive: true });
window.addEventListener("resize", updateCurrentSlide);

function autoAdvanceSlides() {

    const slides = document.querySelectorAll(".slide");

    setInterval(() => {

        updateCurrentSlide();

        currentSlide++;

        if (currentSlide >= slides.length) {
            currentSlide = 0;
        }

        window.scrollTo({
            left: currentSlide * window.innerWidth,
            behavior: "smooth"
        });

    }, 20000);   // ðŸ”¥ 20 seconds
}

async function loadCreatures() {

    const response = await fetch("data/creatures.json");
    const creatures = await response.json();

    const container = document.getElementById("container");

    const audioBeasts = new Set();
    while(audioBeasts.size < 4){
        audioBeasts.add(Math.floor(Math.random() * creatures.length));
    }

    creatures.forEach((creature, i) => {

        const slide = document.createElement("section");
        slide.className = "slide";

        const hasAudio = audioBeasts.has(i);

        slide.innerHTML = `
        <div class="card">

            <h1>Specimen ${String(i+1).padStart(3,"0")}: ${creature.name}</h1>

            <div class="img">
                <img src="images/${creature.id}.png">
            </div>

            <div class="paper">
                <div class="label">name</div>
                <p class="phrase">${creature.name}</p>

                <div class="label">phrase</div>
                <p class="phrase">"${creature.phrase}"</p>
            </div>

            ${hasAudio ? `
            <button onclick="document.getElementById('audio_${i}').play()">
                play tape
            </button>

            <audio id="audio_${i}" preload="none">
                <source src="audio/sound_${i % 4}.wav" type="audio/wav">
            </audio>
            ` : ``}

        </div>
        `;

        container.appendChild(slide);
    });
}

loadCreatures().then(autoAdvanceSlides);

const audioPanel = document.createElement("div");
audioPanel.className = "archive-panel";
audioPanel.innerHTML = `
  <h2>Audio Archive</h2>
  <div class="label">tape 001</div>
  <audio controls preload="none">
    <source src="audio/sound_0.wav" type="audio/wav">
  </audio>
  <div class="label">tape 002</div>
  <audio controls preload="none">
    <source src="audio/sound_1.wav" type="audio/wav">
  </audio>
  <div class="label">tape 003</div>
  <audio controls preload="none">
    <source src="audio/sound_2.wav" type="audio/wav">
  </audio>
  <div class="label">tape 004</div>
  <audio controls preload="none">
    <source src="audio/sound_3.wav" type="audio/wav">
  </audio>
`;

const audioToggle = document.createElement("button");
audioToggle.className = "archive-toggle";
audioToggle.type = "button";
audioToggle.textContent = "Audio Index";
audioToggle.addEventListener("click", () => {
  audioPanel.style.display = audioPanel.style.display === "block" ? "none" : "block";
});

const zoomOverlay = document.createElement("div");
zoomOverlay.className = "image-zoom";
zoomOverlay.innerHTML = `<img alt="Zoomed specimen image">`;
const zoomImg = zoomOverlay.querySelector("img");

document.addEventListener("click", (event) => {
  const targetImg = event.target.closest(".img img");
  if (!targetImg) {
    return;
  }

  zoomImg.src = targetImg.src;
  zoomOverlay.style.display = "grid";
});

function closeZoom() {
  zoomOverlay.style.display = "none";
  zoomImg.src = "";
}

zoomOverlay.addEventListener("click", closeZoom);
document.addEventListener("keydown", (event) => {
  if (event.key === "Escape") {
    closeZoom();
  }
});

document.body.appendChild(audioToggle);
document.body.appendChild(audioPanel);
document.body.appendChild(zoomOverlay);
</script>

</html>
